# IPP-CUPS - IPVLAN-L2
services:
  cups:
    image: anujdatar/cups:latest
    container_name: Cups-server
    restart: unless-stopped
    hostname: cups-server
    
    # Privilegios necesarios para acceder a dispositivos USB
    privileged: true
    
    ports:
      # Puerto para la interfaz web de administración y IPP
      - "631:631"
    
    volumes:
      # Persistencia de configuración de CUPS
      - cups_config:/etc/cups
      # Acceso a dispositivos USB (impresoras conectadas)
      - /dev/bus/usb:/dev/bus/usb
    
    environment:
      - TZ=America/Lima
      - CUPSADMIN=batman
      - CUPSPASSWORD=batcave_password
    
    networks:
      Antares:
        ipv4_address: 192.168.18.115

  # Servicio opcional: Servidor de archivos Samba para compartir impresoras en Windows
  samba:
    image: dperson/samba:aarch64
    container_name: Cups-samba
    restart: unless-stopped
    
    ports:
      - "139:139"
      - "445:445"
    
    environment:
      # Usuario para acceso a impresoras compartidas
      - USER=print;printpass
      # Compartir impresoras de CUPS
      - SHARE=Impresoras;/var/spool/samba;yes;no;no;all;print
    
    volumes:
      - samba_spool:/var/spool/samba
    
    networks:
      Antares:
        ipv4_address: 192.168.18.116
    
    depends_on:
      - cups

volumes:
  cups_config:
    driver: local
  samba_spool:
    driver: local

networks:
  Antares:
    driver: ipvlan
    external: true